{
  "swagger": "2.0",
  "info": {
    "title": "Business-Process-Machine API",
    "description": "Документация API для машины состояний бизнес-процессов.",
    "version": "0.0.1"
  },
  "paths": {
    "/user_registration": {
      "post": {
        "tags": [
          "Регистрация и авторизация"
        ],
        "summary": "Регистрация пользователя",
        "operationId": "UserRegistration",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "Данные пользователя",
            "required": true,
            "schema": {
              "$ref": "#/definitions/RegistrationBody"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Успешная регистрация"
          }
        }
      }
    },
    "/user_authorisation": {
      "post": {
        "tags": [
          "Регистрация и авторизация"
        ],
        "summary": "Авторизация пользователя",
        "operationId": "UserAuthorisation",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "Данные пользователя",
            "required": true,
            "schema": {
              "$ref": "#/definitions/AuthorisationBody"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Успешная авторизация"
          }
        }
      }
    },
    "/user_subscriptions": {
      "post": {
        "tags": [
          "Информация о пользователе"
        ],
        "summary": "Возвращает список подписок пользователя",
        "description": "Возвращает список подписок на бизнес-процессы  определенного пользователя",
        "operationId": "ReturnSubscriptions",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "Логин пользователя, для которого нужно получить подписки",
            "required": true,
            "schema": {
              "$ref": "#/definitions/SubscriptionsBody"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "JSON список пользователей",
            "schema": {
              "$ref": "#/definitions/SubscriptionsResponse"
            }
          }
        }
      }
    },
    "/create_bp": {
      "post": {
        "tags": [
          "Работа с бизнес-процессами"
        ],
        "summary": "Создает бизнес-процесс",
        "description": "Имена бизнес-процессов должны быть уникальны для создающих их пользователя",
        "operationId": "CreateBP",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "Данные для создания бизнес-процесса",
            "required": true,
            "schema": {
              "$ref": "#/definitions/CreateBP_Body"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Успешная создание"
          },
          "420": {
            "description": "Отклонено. Бизнес-процесс с таким названием уже существует"
          }
        }
      }
    },
    "/subscribe_bp": {
      "post": {
        "tags": [
          "Работа с бизнес-процессами"
        ],
        "summary": "Подписывает пользователя на бизнес-процесс",
        "operationId": "SubscribeBP",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "Данные пользователя и бизнес-процесса",
            "required": true,
            "schema": {
              "$ref": "#/definitions/SubscribeBP"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Успешное создание"
          }
        }
      }
    },
    "/delete_bp": {
      "delete": {
        "tags": [
          "Работа с бизнес-процессами"
        ],
        "summary": "Удаляет бизнес-процесс и все состояния",
        "description": "Требуется отправить логин пользователя, название бизнес-процесса, название состояния",
        "operationId": "DeleteBP",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/CreateBP_Body"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Успешно"
          }
        }
      }
    },
    "/user_bps": {
      "post": {
        "tags": [
          "Работа с бизнес-процессами"
        ],
        "summary": "Возвращает бизнес-процессы созданные пользователем",
        "operationId": "GetUserBP",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/UserBPBody"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Успешное создание",
            "schema": {
              "$ref": "#/definitions/UserBPResponse"
            }
          }
        }
      }
    },
    "/create_state": {
      "post": {
        "tags": [
          "Работа с состояниями"
        ],
        "summary": "Создает состояние бизнес-процесса",
        "operationId": "CreateState",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "Данные для создания бизнес-процесса.\nНазвание бизнес-процесса, имя состояния, имя предыдущего состояния, описание, ценность в размере количества очков для рейтинговой системы, дата старта работы над состоянием, дата конца работы (дедлайн), ответственное лицо (опционально)",
            "required": true,
            "schema": {
              "$ref": "#/definitions/CreateStateBody"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Успешное создание"
          }
        }
      }
    },
    "/state_change": {
      "put": {
        "tags": [
          "Работа с состояниями"
        ],
        "summary": "Изменяет данные состояния",
        "operationId": "ChangeBP",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "Данные состояния и бизнес-процесса",
            "required": true,
            "schema": {
              "$ref": "#/definitions/StateChange"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Успешное изменение"
          }
        }
      }
    },
    "/state_done": {
      "post": {
        "tags": [
          "Работа с состояниями"
        ],
        "summary": "Отмечает состояние завершенным",
        "description": "Требуется отправить логин пользователя, название бизнес-процесса, название состояния",
        "operationId": "MarkStateDone",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/MarkStateDoneBody"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Успешно"
          }
        }
      }
    },
    "/state_done_voucher": {
      "post": {
        "tags": [
          "Работа с состояниями"
        ],
        "summary": "Отмечает состояние завершенным со стороны ответсвенного лица",
        "description": "Требуется отправить логин пользователя, название бизнес-процесса, название состояния",
        "operationId": "MarkStateDoneVoucher",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/MarkStateDoneBody"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Успешно"
          }
        }
      }
    },
    "/delete_state": {
      "delete": {
        "tags": [
          "Работа с состояниями"
        ],
        "summary": "Удаляет состояние из бизнес-процесса",
        "description": "Требуется отправить логин пользователя, название бизнес-процесса, название состояния",
        "operationId": "DeleteState",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/MarkStateDoneBody"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Успешно"
          }
        }
      }
    },
    "/voucher_states": {
      "post": {
        "tags": [
          "Работа с состояниями"
        ],
        "summary": "Возвращает все состояния ответственного лица",
        "description": "Возвращает все состояния ответственного лица, которые он должен отметить выполненными по завершению состояния другого пользователя",
        "operationId": "VoucherStates",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/SubscriptionsBody"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Успешно. Возвращает имена пользователей и состояния для них",
            "schema": {
              "$ref": "#/definitions/VoucherStatesResponse"
            }
          }
        }
      }
    }
  },
  "definitions": {
    "SubscriptionsBody": {
      "type": "object",
      "properties": {
        "login": {
          "type": "string"
        }
      }
    },
    "SubscriptionsResponse": {
      "type": "object",
      "properties": {
        "subscriptions": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "RegistrationBody": {
      "type": "object",
      "properties": {
        "email": {
          "type": "string"
        },
        "login": {
          "type": "string"
        },
        "password": {
          "type": "string"
        }
      }
    },
    "AuthorisationBody": {
      "type": "object",
      "properties": {
        "email": {
          "type": "string"
        },
        "login": {
          "type": "string"
        },
        "password": {
          "type": "string"
        }
      }
    },
    "CreateBP_Body": {
      "type": "object",
      "properties": {
        "user_name": {
          "type": "string"
        },
        "bp_name": {
          "type": "string"
        }
      }
    },
    "CreateStateBody": {
      "type": "object",
      "properties": {
        "bp_name": {
          "type": "string"
        },
        "state_name": {
          "type": "string"
        },
        "prev_state": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "points_num": {
          "type": "integer"
        },
        "start_date": {
          "type": "string"
        },
        "end_date": {
          "type": "string"
        },
        "voucher_user": {
          "type": "string"
        }
      }
    },
    "SubscribeBP": {
      "type": "object",
      "properties": {
        "bp_name": {
          "type": "string"
        },
        "user_login": {
          "type": "string"
        }
      }
    },
    "StateChange": {
      "type": "object",
      "properties": {
        "bp_name": {
          "type": "string"
        },
        "state_name": {
          "type": "string"
        },
        "prev_state": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "points_num": {
          "type": "integer"
        },
        "start_date": {
          "type": "string"
        },
        "end_date": {
          "type": "string"
        }
      }
    },
    "UserBPBody": {
      "type": "object",
      "properties": {
        "user_login": {
          "type": "string"
        }
      }
    },
    "UserBPResponse": {
      "type": "object",
      "properties": {
        "user_login": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "MarkStateDoneBody": {
      "type": "object",
      "properties": {
        "user_login": {
          "type": "string"
        },
        "bp_name": {
          "type": "string"
        },
        "state_name": {
          "type": "string"
        }
      }
    },
    "VoucherStatesResponse": {
      "type": "object",
      "properties": {
        "states": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    }
  }
}
